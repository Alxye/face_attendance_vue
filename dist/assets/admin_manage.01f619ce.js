import{d as D,o as f,q as _,b as l,j as v,O as P,_ as E,r as d,c as F,w as s,e as $,t as w,m as L,P as I,D as N,L as H,Q as M,S as j,F as T,v as k,k as B,K as q,a as C,M as G,T as U,E as J}from"./index.344a987f.js";import{b as K}from"./corporation.a1824c9b.js";import{s as Q,h as z}from"./loading.5ace7b54.js";import{g as R}from"./department.b515c038.js";var S=D({name:"Delete"});const W={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},X=l("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32V256zm448-64v-64H416v64h192zM224 896h576V256H224v640zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32zm192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32z"},null,-1);function Y(e,a,n,u,i,m){return f(),_("svg",W,[X])}S.render=Y;S.__file="packages/components/Delete.vue";var Z=S,V=D({name:"Plus"});const x={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},ee=l("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64h352z"},null,-1);function ae(e,a,n,u,i,m){return f(),_("svg",x,[ee])}V.render=ae;V.__file="packages/components/Plus.vue";var te=V,A=D({name:"Search"});const oe={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},le=l("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704z"},null,-1);function ne(e,a,n,u,i,m){return f(),_("svg",oe,[le])}A.render=ne;A.__file="packages/components/Search.vue";var re=A;const se=D({props:{data:{type:Array,default:()=>[]},select:{type:Array,default:()=>[]},showIndex:{type:Boolean,default:!1},showSelection:{type:Boolean,default:!1},showPage:{type:Boolean,default:!0},page:{type:Object,default:()=>({index:1,size:20,total:0})},pageLayout:{type:String,default:"total, sizes, prev, pager, next, jumper"},pageSizes:{type:Array,default:[10,20,50,100]}},setup(e,a){const n=v(null);let u=null;const i=t=>{u?e.page.index=1:(e.page.index=t,a.emit("getTableData"))},m=t=>{u="work",setTimeout(()=>{u=null},100),e.page.size=t,a.emit("getTableData",!0)},c=t=>{a.emit("selection-change",t)};return P(()=>{n.value.doLayout()}),{table:n,handleCurrentChange:i,handleSizeChange:m,handleSelectionChange:c}}}),ue={class:"system-table-box"};function ie(e,a,n,u,i,m){const c=d("el-table-column"),t=d("el-table");return f(),F("div",ue,[l(t,N(e.$attrs,{ref:"table",class:"system-table",border:"",height:"100%",data:e.data,onSelectionChange:e.handleSelectionChange}),{default:s(()=>[e.showIndex?(f(),_(c,{key:0,label:"\u5E8F\u53F7",width:"60",align:"center"},{default:s(y=>[$(w((e.page.index-1)*e.page.size+y.$index+1),1)]),_:1})):L("",!0),I(e.$slots,"default",{},void 0,!0)]),_:3},16,["data","onSelectionChange"])])}var de=E(se,[["render",ie],["__scopeId","data-v-75a64faf"]]);const pe=[{value:2,label:"\u7BA1\u7406\u5458"},{value:3,label:"\u5F85\u5BA1\u6279\u7BA1\u7406\u5458"}],me=D({components:{Layer:H},props:{layer:{type:Object,default:()=>({show:!1,title:"",showButton:!0})}},setup(e,a){const n=v(null),u=v(null);let i=v({staff_id:"",department_id:"",type:""}),m=v([{}]);const c={staff_id:[{required:!0,message:"\u8BF7\u8F93\u5165\u7BA1\u7406\u5458\u5DE5\u53F7",trigger:"blur"}],department_id:[{required:!0,message:"\u8BF7\u9009\u62E9",trigger:"blur"}],type:[{required:!0,message:"\u8BF7\u9009\u62E9",trigger:"blur"}]};t();function t(){e.layer.row&&(i.value=JSON.parse(JSON.stringify(e.layer.row)))}return(b=>{Q(),R().then(h=>{console.log(h);let p=[];for(const o in h.data){if(!h.data.hasOwnProperty(o))continue;const g={label:h.data[o].name,value:h.data[o].id};p.push(g)}m.value=p}).catch(h=>{z()}).finally(()=>{z()})})(),{form:i,rules:c,layerDom:u,ruleForm:n,selectData:m,radioData:pe}},methods:{submit(){this.ruleForm&&this.ruleForm.validate(e=>{if(e){let a=this.form;this.layer.row?this.updateForm(a):this.addForm(a)}else return!1})},addForm(e){console.log(e),M(e).then(a=>{this.$message({type:"success",message:"\u65B0\u589E\u6210\u529F"}),this.$emit("getTableData",!0),this.layerDom&&this.layerDom.close()})},updateForm(e){j(e).then(a=>{this.$message({type:"success",message:"\u7F16\u8F91\u6210\u529F"}),this.$emit("getTableData",!1),this.layerDom&&this.layerDom.close()})}}});function ce(e,a,n,u,i,m){const c=d("el-input"),t=d("el-form-item"),y=d("el-option"),b=d("el-select"),h=d("el-radio"),p=d("el-radio-group"),o=d("el-form"),g=d("Layer",!0);return f(),_(g,{layer:e.layer,onConfirm:e.submit,ref:"layerDom"},{default:s(()=>[l(o,{model:e.form,rules:e.rules,ref:"ruleForm","label-width":"120px",style:{"margin-right":"30px"}},{default:s(()=>[l(t,{label:"\u7BA1\u7406\u5458\u5DE5\u53F7\uFF1A",prop:"staff_id"},{default:s(()=>[l(c,{modelValue:e.form.staff_id,"onUpdate:modelValue":a[0]||(a[0]=r=>e.form.staff_id=r),placeholder:"\u8BF7\u8F93\u5165\u5DE5\u53F7"},null,8,["modelValue"])]),_:1}),l(t,{label:"\u6240\u5C5E\u90E8\u95E8\uFF1A",prop:"select"},{default:s(()=>[l(b,{modelValue:e.form.department_id,"onUpdate:modelValue":a[1]||(a[1]=r=>e.form.department_id=r),placeholder:"\u8BF7\u9009\u62E9",clearable:""},{default:s(()=>[(f(!0),F(T,null,k(e.selectData,r=>(f(),_(y,{key:r.value,label:r.label,value:r.value},{default:s(()=>[$(w(r.label),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(t,{label:"\u7C7B\u578B\uFF1A",prop:"radio"},{default:s(()=>[l(p,{modelValue:e.form.type,"onUpdate:modelValue":a[2]||(a[2]=r=>e.form.type=r)},{default:s(()=>[(f(!0),F(T,null,k(e.radioData,r=>(f(),_(h,{key:r.value,label:r.value},{default:s(()=>[$(w(r.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["layer","onConfirm"])}var fe=E(me,[["render",ce]]);const he=D({name:"crudTable",components:{Table:de,Layer:fe},setup(){const e=B({input:""}),a=B({show:!1,title:"\u65B0\u589E",showButton:!0}),n=B({index:1,size:20,total:0}),u=v(!0),i=v([]),m=v([]),c=p=>{m.value=p},t=p=>{u.value=!0,p&&(n.index=1),{page:n.index,pageSize:n.size,...e},K().then(o=>{o.data.list;let g=[];for(const r in o.data.list){if(!o.data.list.hasOwnProperty(r))continue;const O=o.data.list[r];g.push(O)}i.value=g,n.total=Number(o.data.pager.total)}).catch(o=>{i.value=[],n.index=1,n.total=0}).finally(()=>{u.value=!1})},y=p=>{let o={staff_id:p.map(g=>g.staff_id).join(",")};console.log(o),U(o).then(g=>{J({type:"success",message:"\u5220\u9664\u6210\u529F"}),t(i.value.length===1)})},b=()=>{a.title="\u65B0\u589E\u7BA1\u7406\u5458",a.show=!0,delete a.row},h=p=>{a.title="\u7F16\u8F91\u7BA1\u7406\u5458",a.row=p,a.show=!0};return t(!0),{Plus:te,Search:re,Delete:Z,query:e,tableData:i,chooseData:m,loading:u,page:n,layer:a,handleSelectionChange:c,handleAdd:b,handleEdit:h,handleDel:y,getTableData:t}}}),ge={class:"layout-container"},_e={class:"layout-container-form flex space-between"},ye={class:"layout-container-form-handle"},ve={class:"layout-container-table"};function be(e,a,n,u,i,m){const c=d("el-button"),t=d("el-table-column"),y=d("el-popconfirm"),b=d("Table"),h=d("Layer"),p=q("loading");return f(),F("div",ge,[C("div",_e,[C("div",ye,[l(c,{type:"primary",icon:e.Plus,onClick:e.handleAdd},{default:s(()=>[$(w(e.$t("message.common.add")),1)]),_:1},8,["icon","onClick"])])]),C("div",ve,[G((f(),_(b,{ref:"table",page:e.page,"onUpdate:page":a[0]||(a[0]=o=>e.page=o),showIndex:!0,showSelection:!0,data:e.tableData,onGetTableData:e.getTableData,onSelectionChange:e.handleSelectionChange},{default:s(()=>[l(t,{prop:"staff_id",label:"\u5DE5\u53F7",align:"center"}),l(t,{prop:"type_name",label:"\u7C7B\u578B",align:"center"}),l(t,{prop:"department_name",label:"\u90E8\u95E8\u6240\u5C5E",align:"center"}),l(t,{label:e.$t("message.common.handle"),align:"center",fixed:"right",width:"200"},{default:s(o=>[l(c,{onClick:g=>e.handleEdit(o.row)},{default:s(()=>[$(w(e.$t("message.common.update")),1)]),_:2},1032,["onClick"]),l(y,{title:e.$t("message.common.delTip"),onConfirm:g=>e.handleDel([o.row])},{reference:s(()=>[l(c,{type:"danger"},{default:s(()=>[$(w(e.$t("message.common.del")),1)]),_:1})]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1},8,["page","data","onGetTableData","onSelectionChange"])),[[p,e.loading]]),e.layer.show?(f(),_(h,{key:0,layer:e.layer,onGetTableData:e.getTableData},null,8,["layer","onGetTableData"])):L("",!0)])])}var Be=E(he,[["render",be]]);export{Be as default};
